<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <script type="text/javascript">
    document.addEventListener("DOMContentLoaded",main)

    function main(){
        let agenda = []
        const insBtn = document.querySelector("#insBtn")
        const sortByNameBtn = document.querySelector("#sortByNameBtn")
        const sortByTelBtn = document.querySelector("#sortByTelBtn")
        const name = document.querySelector("#name")
        const tel = document.querySelector("#tel")
        const search = document.querySelector("#search")
        const tbody = document.querySelector("table>tbody")

        name.focus()
        name.addEventListener("keyup",function(ev){
            if (ev.key == "Enter") {
                tel.focus()
            }
        })
        tel.addEventListener("keyup",function(ev){
            if (ev.key == "Enter") {
                insertAndEmptyForm()
            }
        })
        insBtn.addEventListener("click",function(){
            insertAndEmptyForm()
        })
        sortByNameBtn.addEventListener("click",function(){
            //ordenar agenda por nombre
        })
        sortByTelBtn.addEventListener("click",function(){
            //ordenar agenda por nº tel
        })
        function insertAndEmptyForm() {
            if (nameOK() && telOK()) {
                agenda.push({
                    name: name.value,
                    tel: tel.value
                })
                refreshTable()
                name.value = ""
                tel.value = ""
                name.focus()
            }
        }
        function nameOK() {
            return (name.value.trim() != "")
        }
        function telOK() {
            let expreg1 = /^\d{9}$/
            let expreg2 = /^[0-9]{9}$/
            return ( expreg1.test(tel.value.trim()) )
        }
        function refreshTable(){
            //vaciar el TBODY
            tbody.innerHTML = ""
            //mostrar en el TABLE todos los contactos de nuestra agenda
            let index = 0
            agenda.forEach(c => {
                //crear una nueva fila y sus celdas en el tbody
                let newTR = tbody.insertRow()
                let newTD1 = newTR.insertCell()
                let newTD2 = newTR.insertCell()
                let newTD3 = newTR.insertCell()
                //mostrar valores en las columnas
                newTD1.textContent = c.name
                newTD2.textContent = c.tel
                newTD3.innerHTML = "<button class='btn btn-danger'>X</button>"
                const delBtn = newTD3.querySelector("button")
                delBtn.dataset.position = index
                index++
                delBtn.addEventListener("click",function(){
                    //borrar dicho elemento del array
                    agenda.splice(delBtn.dataset.position, 1)
                    refreshTable()
                })
            })
        } //fin función REFRESHTABLE
    } //fin función MAIN
    </script>
</head>
<body>
    <div class="container">
    <div class="row mt-4">
        <div class="input-group flex-nowrap">
        <span class="input-group-text" id="addon-wrapping">NAME</span>
        <input id="name" type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="addon-wrapping">
        </div>

        <div class="input-group flex-nowrap">
            <span class="input-group-text" id="addon-wrapping">TELEPHONE</span>
            <input id="tel" type="text" class="form-control" placeholder="Phone number" aria-label="Username" aria-describedby="addon-wrapping">
        </div>

        <button id="insBtn" type="button" class="btn btn-success">Insert</button>
    </div>

    <div class="row mt-4">
        <div class="input-group mb-3">
            <input id="search" type="text" class="form-control" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="button-addon2">
            <button class="btn btn-outline-secondary" type="button" id="searchBtn">Search</button>
        </div>
        <table class="table">
            <thead>
                <th>
                    NAME
                    <button id="sortByNameBtn" class="btn btn-outline-info">A-Z</button>
                </th>
                <th>
                    TELEPHONE
                    <button id="sortByTelBtn" class="btn btn-outline-info">0-9</button>
                </th>
                <th>ACTIONS</th>
            </thead>
            <tbody></tbody>
            <tfoot></tfoot>
        </table>
    </div>

    </div>
</body>
</html>